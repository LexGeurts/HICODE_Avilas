version: "3.1"


intents:
  - greet
  - goodbye
  - affirm
  - deny
  - ask_recipe
  - ask_healthiness
  - ask_recipe_explanation
#  - inform_allergy
  - ask_unsupported_medical_advice
  - ask_ingredient_pairing

entities:
  - ingredient
  - food_item

slots:
  ingredients:
    type: text
    initial_value: " " # Empty
    influence_conversation: true
    # The LLM will extract a list of ingredients from the user's text.
    mappings:
      - type: from_llm
  food_item:
    type: text
    influence_conversation: true
    # The LLM will extract a food item from the user's text.
    mappings:
      - type: from_llm
  query_wish:
    type: text
    initial_value: " " # Emptys
    influence_conversation: true
    # The LLM will extract a recipe preference from the user's text.
    mappings:
      - type: from_llm
  wants_explanation:
    type: bool
    initial_value: False
    influence_conversation: true
    mappings:
      - type: from_llm
  error:
    type: bool
    influence_conversation: false
    mappings:
      - type: custom
  last_recipe_name:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  last_recipe_id:
    type: text
    influence_conversation: false
    mappings:
      - type: custom



responses:
  utter_greet:
    - text: "Hi! I'm BrainFuel. I can help you find healthy and affordable recipes. You can ask me for a recipe with ingredients you have, or ask if a food is healthy."
  utter_goodbye:
    - text: "Goodbye! Happy cooking!"
  utter_ask_ingredients:
    - text: "What ingredients do you have at home?"
  utter_can_do_something_else:
    - text: "What else can I help you with?"
      metadata:
        rephrase: False
  utter_handle_out_of_scope:
    - text: "I specialize in recipes and nutrition! I can't help with that. How about we talk about the health benefits of food instead?"
  utter_handle_allergy:
    - text: "Unfortunately, I donâ€™t provide information on allergies. Please be careful and check the ingredients yourself."
      metadata:
        rephrase: False
  utter_handle_unsupported_request:
    - text: "My purpose is to help you learn about food choices and nutrient values, but I am not a substitute for a personalized dietary plan or medical advice. Please consult a doctor or nutritionist for specific guidance."
  utter_ask_wants_explanation_recipe:
    - text: "You can also ask me why this recipe is healthy!"
  utter_ask_food_item:
    - text: "What food item or ingredient would you like to know about?"
  utter_ask_query_wish:
    - text: "What wishes do you have regarding a recipe, such as low salt, healthy, vegan, etc?"
  utter_free_chitchat_response:
    - text: "placeholder"
      metadata:
        rephrase: True
        rephrase_prompt: |
          The following is a conversation with a specialized AI assistant named 'BrainFuel'.
          ASSISTANT PURPOSE:
          BrainFuel is strictly dedicated to assisting students with finding healthy and affordable food, providing recipes, and assessing the nutritional healthiness of ingredients.
          STRICT OPERATIONAL CONSTRAINTS:
          NO FIRST-PERSON: Do not use words like "I", "my", "me", "we", or "our". All responses must be objective and third-person (e.g., "The health benefits are..." instead of "I think the benefits are...").
          DOMAIN LOCK: BrainFuel only provides information regarding food, nutrition, and health.
          OFF-TOPIC REDIRECTION: If the user asks about anything other than food (e.g., music, celebrities, sports, general advice), do NOT answer the question. Do not provide facts, opinions, or "polite" partial answers. Instead, acknowledge the query and immediately state that BrainFuel is focused on nutrition, then ask a food-related follow-up.
          INFO SPEARFISHING: Prioritize direct, information-rich answers. Avoid fluff. Question leads to a direct answer.
          PERSONA: Maintain a knowledgeable, supportive, friendly, and encouraging but strictly formal tone.
          SMALL TALK PROTOCOL:
          If a user initiates small talk, respond politely while keeping the focus on food. Do not engage in deep conversation about personal feelings or unrelated topics. Always steer the conversation back to food search, recipes, or health assessments.
          Context / previous conversation with the user:
          {{history}}
          User Input:
          {{current_input}}
  utter_clarify:
    - text: "I'd be happy to help. To do that, I need a bit more information from you. What would you like help with? Do you want a recipe, or would you like to know if a food item is healthy?"

  utter_resuming_your_flow:
    - text: "Let me get back to your request."
      metadata:
        rephrase: True
  utter_ingredient_pairing:
    - text: "Great question! Google has got you covered for most ingredient pairing" # We do not give pairing options


actions:
  - action_search_recipe
  - action_check_healthiness
  - action_explain_recommendation
  - action_check_interrupted_flow

#Handling intentless patterns (This doesnt work because no valid OPENAI key is available)
# intentless_policy_patterns:
#   - pattern: "ingredient pairing suggestions"
#     response: "I can suggest complementary ingredients. For tomato, ingredients like basil, mozzarella, garlic, olive oil, and balsamic vinegar work wonderfully together."